# OWASP top ten

&nbsp;

## A01（失效的访问控制）

### 【风险说明】

* 访问强制实施策略，使用户无法在其预期权限之外操作。失败的访问控制通常导致未经授权的信息泄露，修改或者销毁所有数据，或在用户权限之外执行业务功能。

### 【例子】

* 将敏感信息泄露给未经授权的参与者
* 通过发送的数据泄露敏感信息
* 跨站请求伪造（csrf）

### 【常见访问控制脆弱点】

* 违法最小权限原则或默认拒绝原则，即访问权限应只授予特定能力、角色或用户，但实际上任何人都可以访问
* 通过修改URL（参数修改或强制浏览），内部应用程序状态或者HTML页面，或者使用修改API请求的攻击工具绕过访问控制检查
* 通过提供唯一的标识符允许查看或编辑他人账户
* API没有对POST、PUT和DELETE强制执行访问控制
* 特权提升，在未登陆的情况下假扮用户或以用户身份登入时充当管理员

&nbsp;


## A02（加密机制失效）

### 【风险说明】

* 首先要确认：对传输中的数据和存储数据都有哪些保护需求。例如：密码、信用卡号、医疗记录、个人信息和商业秘密需要额外保护
* 其以前被称为“A3:2017-敏感信息泄漏（Sensitive Data Exposure）”。敏感信息泄漏是常见的症状，而非根本原因。更新后的名称侧重于与密码学相关的风险，即之前已经隐含的根本原因。此类风险通常会导致敏感数据泄露或系统被攻破。


### 【常见脆弱点】

* 在传输数据过程中是否使用明文传输？这和传输协议有关：HTTP、SMTP、经过TLS升级的FTP。外部网络流量是有害的，需要验证所有的内部通信
* 无论是在默认情况还是在旧的代码中，是否还在使用任何旧或者脆弱的加密算法或传输协议
* 是否默认使用加密密钥、生成或重复使用脆弱的加密密钥，或者是否缺少适当的密钥管理或密钥回转
* 接收到的服务器证书和信任链是否经过正确验证

&nbsp;


## A03（注入）

### 【风险说明】

* 源代码审查是检查应用程序是否易受注入攻击的最佳方法
* 94%的应用程序进行了某种形式的注入风险测试，发生安全事件的最大率为19%，平均率为3.37%，匹配到此类别的33个CWE共发生27.4万次，是出现第二多的风险类别。原“A07:2017-跨站脚本（XSS）”在2021年版中被纳入此风险类别。

### 【例子】

* 常见的CWE：跨站点脚本、SQL注入、文件名或路径的外部控制

### 【常见脆弱点】

* 应用程序不会验证、过滤或清洗用户提供的数据
* 动态查询或无上下文感知转义的非参数化调用之间在解释器中使用
* 恶意数据被直接使用或连接。SQL或命令包含动态查询、命令或存储过程中的结构和恶意数据


&nbsp;


## A04（不安全的设计）

### 【风险说明】

* 不安全设计和不安全实现直接存在差异，我们区别设计缺陷和实现缺陷是有原因的，安全设计仍然可能存在实现缺陷，从而导致可能被利用的漏洞。
* 2021年版的一个新类别，其重点关注与设计缺陷相关的风险。如果我们真的想让整个行业“安全左移” ，我们需要更多的威胁建模、安全设计模式和原则，以及参考架构。不安全设计是无法通过完美的编码来修复的；因为根据定义，所需的安全控制从来没有被创建出来以抵御特定的安全攻击。


&nbsp;


## A05（安全配置错误）

### 【风险说明】

* 90%都进行了某种形式的配置错误测试
* 缺少一个体系的、可重复的应用程序安全配置过程，系统将处于高风险中
* 90%的应用程序都进行了某种形式的配置错误测试，平均发生率为4.5%，超过20.8万次的CWE匹配到此风险类别。随着可高度配置的软件越来越多，这一类别的风险也开始上升。原“A04:2017-XML External Entities(XXE) XML外部实体”在2021年版中被纳入此风险类别。

### 【常见脆弱点】

* 应用程序栈的任何部分缺少适当的安全加固，或者云服务的权限配置错误
* 应用程序启用或安装了不必要的功能（例如：不必要的端口、服务、网页、账户或权限）
* 默认账户和密码仍然可用且没有更改
* 错误处理机制向用户纰漏堆栈信息或其他大量错误信息
* 对于升级的系统，最新的安全特性被禁用或未安全配置
* 应用程序服务器、应用程序框架（如：Struts、Spring、ASP。net）、库文件、数据库等没有进行安全配置


&nbsp;


## A06（自带缺陷和过时的组件）

### 【风险说明】

* 不安全的组件是我们努力测试和评估风险的已知问题
* 通过数据分析也有足够的数据进入前10名，是我们难以测试和评估风险的已知问题。它是唯一一个没有发生CVE漏洞的风险类别。因此，默认此类别的利用和影响权重值为5.0。原类别命名为“A09:2017-Using Components with Known Vulnerabilities 使用含有已知漏洞的组件”。

### 【常见脆弱点】

* 你不知道所使用的组件版本信息（包括：服务端和客户端）。这包括了直接使用的组件或间接依赖的组件
* 软件易受攻击，不再支持或过时。
* 没有定期做漏洞扫描和订阅使用组件的安全公告
* 软件工程师没有对更新的、升级的或者打过补丁的组件进行兼容性测试
* 没有对组件进行安全配置


&nbsp;


## A07（身份识别和身份验证错误）

### 【风险说明】

* 之前称为无效的身份认证，此类别从第二名下滑，现在包含了与身份识别失效相关的CWE
* 原标题“A02:2017-Broken Authentication失效的身份认证”。现在包括了更多与识别错误相关的CWE。这个类别仍然是Top 10的组成部分，但随着标准化框架使用的增加，此类风险有减少的趋势。

### 【脆弱点】

* 允许像是攻击者已经拥有有效用户名称和密码列表的撞库自动化攻击
* 允许暴力或其他自动化攻击
* 允许预设、脆弱、常见的密码
* 使用脆弱或无效的认证资讯回复或忘记密码的流程
* 使用明码，被加密的或使用较脆弱杂凑法的密码


&nbsp;



## A08（软件和数据完整性故障）

### 【风险说明】

* 2021年版的一个新类别，其重点是：在没有验证完整性的情况下做出与软件更新、关键数据和CI/CD管道相关的假设。此类别共有10个匹配的CWE类别，并且拥有最高的平均加权影响值。原“A08:2017-Insecure Deserialization不安全的反序列化”现在是本大类的一部分。


&nbsp;



## A09（安全日志和监控故障）

### 【风险说明】

* 如果不进行日志记录和检测，就无法发现任何违规行为，任何时候都会发现日志记录、检测、监视和主动响应不足的情况
* 排名上升一位。来源于社区调查（排名第3）。原名为“A10:2017-Insufficient Logging & Monitoring 不足的日志记录和监控”。此类别现扩大范围，包括了更多类型的、难以测试的故障。此类别在 CVE/CVSS 数据中没有得到很好的体现。但是，此类故障会直接影响可见性、事件告警和取证。


### 【脆弱点】

* 日志只存储在本地
* 渗透测试和动态应用安全测试工具的扫描没有触发情报
* 警告和错误生成的日志或日志记录不充分或日志消息不清晰


&nbsp;



## A10（服务端请求伪造（ssrf））

### 【风险说明】

* 一旦web应用程序在获取远程资源时没有验证用户提供的URL，就会出现ssrf缺陷。它允许攻击者强制应用程序发送一个精心构造的请求到意外的目的地，即使是在有防火墙，VPN获其他类型的网络访问控制列表保护的情况下
